{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./index.lsc","webpack:///external \"delay\"","webpack:///external \"dotenv\"","webpack:///external \"download\"","webpack:///external \"nightmare\"","webpack:///external \"ora\"","webpack:///external \"p-map\"","webpack:///external \"path\""],"names":["require","config","show","Number","process","env","NUM_DOWNLOADS_AT_A_TIME","numberOfVideos","start","nightmare","goto","insert","EMAIL","PASSWORD","click","wait","COURSE_TO_SCRAPE","evaluate","document","title","replace","querySelectorAll","map","videoName","videoLink","textContent","videoPageUrl","href","courseTitle","filter","length","then","videos","spinner","text","getVideoSrcUrls","concurrency","downloadVideo","numDownloadsAtATime","end","catch","log","e","video","index","useragent","querySelector","src","videoSrcUrl","path","join","filename","getRandomInt","min","max","floor","Math","random"],"mappings":"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","file":"index-compiled.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./index.lsc\");\n","\r\nrequire('dotenv').config()\r\n\r\nimport path from 'path'\r\n\r\nimport Nightmare from 'nightmare'\r\nimport pMap from 'p-map'\r\nimport download from 'download'\r\nimport ora from 'ora'\r\nimport delay from 'delay'\r\n\r\nnightmare = Nightmare({ show: false })\r\nnumDownloadsAtATime = Number(process.env.NUM_DOWNLOADS_AT_A_TIME) || 1\r\nuseragent = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36'\r\n\r\nlet numberOfVideos = 0\r\n\r\nspinner = ora('Logging in').start()\r\n\r\nnightmare\r\n  .goto('https://app.pluralsight.com/id/')\r\n  .insert('#Username', process.env.EMAIL)\r\n  .insert('#Password', process.env.PASSWORD)\r\n  .click('#login')\r\n  .wait(1000)\r\n  .goto(process.env.COURSE_TO_SCRAPE)\r\n  .wait(3000)\r\n  .evaluate(() ->\r\n    courseTitle = document.title.replace(\" | Pluralsight\", \"\")\r\n    [...document.querySelectorAll('.table-of-contents__clip-list-item a')]\r\n    .map(videoLink ->\r\n      {\r\n        videoName: videoLink.textContent.replace(/[^a-z ]/ig, \"\"), // so safe filename\r\n        videoPageUrl: videoLink.href,\r\n        courseTitle\r\n      }\r\n    )\r\n    .filter(video -> video.videoPageUrl.length > 0)\r\n  )\r\n  .then(videos ->\r\n    now numberOfVideos = videos.length\r\n    spinner.text = 'Scraping video links'\r\n    pMap(\r\n      videos,\r\n      getVideoSrcUrls,\r\n      {concurrency: 1}\r\n    )\r\n  )\r\n  .then(videos ->\r\n    pMap(\r\n      videos,\r\n      downloadVideo,\r\n      {concurrency: numDownloadsAtATime}\r\n    )\r\n  )\r\n  .then(() -> nightmare.end())\r\n  .catch(e -> console.log(e))\r\n\r\ngetVideoSrcUrls(video, index):Promise ->\r\n  randomDelay().then(() ->\r\n    spinner.text = `Scraping [${ index + 1 }/${ numberOfVideos }]: ${ video.videoName }`\r\n    nightmare\r\n      .useragent(useragent)\r\n      .goto(video.videoPageUrl)\r\n      .wait(\"video\")\r\n      .wait(1500)\r\n      .evaluate(() -> document.querySelector(\"video\").src)\r\n      .then(videoSrcUrl -> {...video, videoSrcUrl})\r\n  )\r\n\r\ndownloadVideo({videoSrcUrl, courseTitle, videoName}, index):Promise ->\r\n  randomDelay().then(() ->\r\n    spinner.text = `Downloading [${ index + 1 }/${ numberOfVideos }]: ${ videoName }`\r\n    download(\r\n      videoSrcUrl,\r\n      path.join('videos', courseTitle),\r\n      { filename: `${ index + 1 }. ${ videoName }.webm` }\r\n    )\r\n    .then(() ->\r\n      spinner.text = `Download [${ index + 1 }/${ numberOfVideos }]: ${ videoName } completed`\r\n    )\r\n  )\r\n\r\nrandomDelay():Promise ->\r\n  delay(getRandomInt(1, 15) * 1000)\r\n\r\ngetRandomInt(min, max) ->\r\n  Math.floor(Math.random() * (max - min + 1)) + min\r\n","module.exports = require(\"delay\");","module.exports = require(\"dotenv\");","module.exports = require(\"download\");","module.exports = require(\"nightmare\");","module.exports = require(\"ora\");","module.exports = require(\"p-map\");","module.exports = require(\"path\");"],"sourceRoot":""}